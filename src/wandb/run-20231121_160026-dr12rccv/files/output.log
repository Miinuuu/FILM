Running tests under Python 3.9.18: /home/jmw/anaconda3/envs/vct_tf/bin/python
[ RUN      ] ModelsTest.test_session
[  SKIPPED ] ModelsTest.test_session
[ RUN      ] ModelsTest.test_train_eval
  0%|                                                                                                                                                       | 0/81 [00:00<?, ?batch/s]
  0%|                                                                                                                                                     | 0/3782 [00:00<?, ?batch/s]
resume /home/jmw/ing/myfi/vfi/ckpt
load a checkpoint at/home/jmw/ing/myfi/vfi/ckptfor/home/jmw/ing/myfi/vfi/ckpt/ckpt-0
Creates a checkpoint at/home/jmw/ing/myfi/vfi/ckptfor0























































100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉| 3781/3782 [01:57<00:00, 34.21batch/s]
  0%|                                                                                                                                                       | 0/81 [01:58<?, ?batch/s]
INFO:tensorflow:time(__main__.ModelsTest.test_train_eval): 119.1s
I1121 16:02:28.072889 139681161372032 test_util.py:2460] time(__main__.ModelsTest.test_train_eval): 119.1s
[  FAILED  ] ModelsTest.test_train_eval
======================================================================
ERROR: test_train_eval (__main__.ModelsTest)
ModelsTest.test_train_eval
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/home/jmw/ing/myfi/vfi/src/models_test.py", line 99, in test_train_eval
    metrics=train_step(img0,gt,img1)
  File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/util/traceback_utils.py", line 141, in error_handler
    return fn(*args, **kwargs)
  File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/eager/def_function.py", line 915, in __call__
    result = self._call(*args, **kwds)
  File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/eager/def_function.py", line 963, in _call
    self._initialize(args, kwds, add_initializers_to=initializers)
  File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/eager/def_function.py", line 785, in _initialize
    self._stateful_fn._get_concrete_function_internal_garbage_collected(  # pylint: disable=protected-access
  File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/eager/function.py", line 2523, in _get_concrete_function_internal_garbage_collected
    graph_function, _ = self._maybe_define_function(args, kwargs)
  File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/eager/function.py", line 2760, in _maybe_define_function
    graph_function = self._create_graph_function(args, kwargs)
  File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/eager/function.py", line 2670, in _create_graph_function
    func_graph_module.func_graph_from_py_func(
  File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/framework/func_graph.py", line 1247, in func_graph_from_py_func
    func_outputs = python_func(*func_args, **func_kwargs)
  File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/eager/def_function.py", line 677, in wrapped_fn
    out = weak_wrapped_fn().__wrapped__(*args, **kwds)
  File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/framework/func_graph.py", line 1233, in autograph_handler
    raise e.ag_error_metadata.to_exception(e)
tensorflow.python.framework.errors_impl.NotFoundError: in user code:
    File "/home/jmw/ing/myfi/vfi/src/model.py", line 266, in train_step  *
        pred,metric = self.interpolator(img0,gt,img1)
    File "/home/jmw/ing/myfi/vfi/src/model.py", line 300, in interpolator  *
        af, mf  = self.feature_estimation(img0, img1) # feature extractor [[2,256,30,60],,...]5개, [[2,256,30,60],...] 3개
    File "/home/jmw/ing/myfi/vfi/src/model.py", line 136, in __call__  *
        x = block(x)  # C C C
    File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/keras/utils/traceback_utils.py", line 61, in error_handler  **
        return fn(*args, **kwargs)
    File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/keras/engine/base_layer.py", line 1097, in __call__
        outputs = call_fn(inputs, *args, **kwargs)
    File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/keras/utils/traceback_utils.py", line 155, in error_handler
        raise new_e.with_traceback(e.__traceback__) from None
    File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/keras/utils/traceback_utils.py", line 96, in error_handler
        return fn(*args, **kwargs)
    NotFoundError: Exception encountered when calling layer "conv_block" "                 f"(type ConvBlock).
    in user code:
        File "/home/jmw/ing/myfi/vfi/src/modules.py", line 421, in call  *
            x = self.layers(x)
        File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/keras/utils/traceback_utils.py", line 61, in error_handler  **
            return fn(*args, **kwargs)
        File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/keras/engine/training.py", line 557, in __call__
            return super().__call__(*args, **kwargs)
        File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/keras/utils/traceback_utils.py", line 61, in error_handler
            return fn(*args, **kwargs)
        File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/keras/engine/base_layer.py", line 1097, in __call__
            outputs = call_fn(inputs, *args, **kwargs)
        File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/keras/utils/traceback_utils.py", line 155, in error_handler
            raise new_e.with_traceback(e.__traceback__) from None
        File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/keras/utils/traceback_utils.py", line 96, in error_handler
            return fn(*args, **kwargs)
        File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/keras/engine/sequential.py", line 425, in call
            outputs = layer(inputs, **kwargs)
        File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/keras/utils/traceback_utils.py", line 61, in error_handler
            return fn(*args, **kwargs)
        File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/keras/engine/base_layer.py", line 1089, in __call__
            self._maybe_build(inputs)
        File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/keras/engine/base_layer.py", line 2949, in _maybe_build
            self.build(input_shapes)
        File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/keras/layers/convolutional/base_conv.py", line 220, in build
            self.kernel = self.add_weight(
        File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/keras/engine/base_layer.py", line 705, in add_weight
            variable = self._add_variable_with_custom_getter(
        File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/trackable/base.py", line 489, in _add_variable_with_custom_getter
            new_variable = getter(
        File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/keras/engine/base_layer_utils.py", line 134, in make_variable
            return tf1.Variable(
        File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/util/traceback_utils.py", line 141, in error_handler
            return fn(*args, **kwargs)
        File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/ops/variables.py", line 264, in __call__
            return cls._variable_v1_call(*args, **kwargs)
        File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/ops/variables.py", line 209, in _variable_v1_call
            return previous_getter(
        File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/ops/variables.py", line 64, in getter
            return captured_getter(captured_previous, **kwargs)
        File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/eager/def_function.py", line 772, in variable_capturing_scope
            v = UnliftedInitializerVariable(
        File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/util/traceback_utils.py", line 141, in error_handler
            return fn(*args, **kwargs)
        File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/ops/variables.py", line 268, in __call__
            return super(VariableMetaclass, cls).__call__(*args, **kwargs)
        File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/eager/def_function.py", line 296, in __init__
            initial_value = initial_value()
        File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/trackable/base.py", line 115, in __call__
            return CheckpointInitialValue(
        File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/trackable/base.py", line 145, in __init__
            self.wrapped_value = checkpoint_position.value_tensors(
        File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/checkpoint/restore.py", line 129, in value_tensors
            value, = io_ops.restore_v2(
        File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1506, in restore_v2
            return restore_v2_eager_fallback(
        File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/ops/gen_io_ops.py", line 1545, in restore_v2_eager_fallback
            _result = _execute.execute(b"RestoreV2", len(dtypes), inputs=_inputs_flat,
        File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/eager/execute.py", line 54, in quick_execute
            tensors = pywrap_tfe.TFE_Py_Execute(ctx._handle, device_name, op_name,
        NotFoundError: Exception encountered when calling layer "sequential" "                 f"(type Sequential).
        {{function_node __wrapped__RestoreV2_dtypes_1_device_/job:localhost/replica:0/task:0/device:CPU:0}} Key model/_all_trainable_variables/1/.ATTRIBUTES/VARIABLE_VALUE not found in checkpoint [Op:RestoreV2]
        Call arguments received by layer "sequential" "                 f"(type Sequential):
          • inputs=tf.Tensor(shape=(128, 256, 256, 3), dtype=float32)
          • training=False
          • mask=None
    Call arguments received by layer "conv_block" "                 f"(type ConvBlock):
      • x=tf.Tensor(shape=(128, 256, 256, 3), dtype=float32)
----------------------------------------------------------------------
Ran 2 tests in 119.105s
FAILED (errors=1, skipped=1)