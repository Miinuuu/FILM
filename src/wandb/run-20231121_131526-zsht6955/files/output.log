Running tests under Python 3.9.18: /home/jmw/anaconda3/envs/vct_tf/bin/python
[ RUN      ] ModelsTest.test_session
[  SKIPPED ] ModelsTest.test_session
[ RUN      ] ModelsTest.test_train_eval
  0%|                                                                                                                                                      | 0/12829 [00:00<?, ?batch/s]
INFO:tensorflow:time(__main__.ModelsTest.test_train_eval): 1.33s
I1121 13:15:30.074014 139751818764672 test_util.py:2460] time(__main__.ModelsTest.test_train_eval): 1.33s
[  FAILED  ] ModelsTest.test_train_eval
======================================================================
ERROR: test_train_eval (__main__.ModelsTest)
ModelsTest.test_train_eval
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/home/jmw/ing/myfi/vfi/src/models_test.py", line 87, in test_train_eval
    metrics=train_step(img0,gt,img1)
  File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/util/traceback_utils.py", line 141, in error_handler
    return fn(*args, **kwargs)
  File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/eager/def_function.py", line 915, in __call__
    result = self._call(*args, **kwds)
  File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/eager/def_function.py", line 963, in _call
    self._initialize(args, kwds, add_initializers_to=initializers)
  File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/eager/def_function.py", line 785, in _initialize
    self._stateful_fn._get_concrete_function_internal_garbage_collected(  # pylint: disable=protected-access
  File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/eager/function.py", line 2523, in _get_concrete_function_internal_garbage_collected
    graph_function, _ = self._maybe_define_function(args, kwargs)
  File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/eager/function.py", line 2760, in _maybe_define_function
    graph_function = self._create_graph_function(args, kwargs)
  File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/eager/function.py", line 2670, in _create_graph_function
    func_graph_module.func_graph_from_py_func(
  File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/framework/func_graph.py", line 1247, in func_graph_from_py_func
    func_outputs = python_func(*func_args, **func_kwargs)
  File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/eager/def_function.py", line 677, in wrapped_fn
    out = weak_wrapped_fn().__wrapped__(*args, **kwds)
  File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/framework/func_graph.py", line 1233, in autograph_handler
    raise e.ag_error_metadata.to_exception(e)
  File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/framework/func_graph.py", line 1222, in autograph_handler
    return autograph.converted_call(
  File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/autograph/impl/api.py", line 439, in converted_call
    result = converted_f(*effective_args, **kwargs)
  File "/tmp/__autograph_generated_fileug_8ng53.py", line 12, in tf__train_step
    (pred, metric) = ag__.converted_call(ag__.ld(self).interpolator, (ag__.ld(img0), ag__.ld(gt), ag__.ld(img1)), None, fscope)
  File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/autograph/impl/api.py", line 441, in converted_call
    result = converted_f(*effective_args)
  File "/tmp/__autograph_generated_fileq_k8v6jv.py", line 18, in tf__interpolator
    (af, mf) = ag__.converted_call(ag__.ld(self).feature_estimation, (ag__.ld(img0), ag__.ld(img1)), None, fscope)
  File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/autograph/impl/api.py", line 441, in converted_call
    result = converted_f(*effective_args)
  File "/tmp/__autograph_generated_fileenj3fbm_.py", line 108, in tf____call__
    ag__.for_stmt(ag__.converted_call(ag__.ld(range), (ag__.ld(self).num_stages,), None, fscope), None, loop_body_1, get_state_4, set_state_4, ('x',), {'iterate_names': 'i'})
  File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/autograph/operators/control_flow.py", line 463, in for_stmt
    _py_for_stmt(iter_, extra_test, body, None, None)
  File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/autograph/operators/control_flow.py", line 512, in _py_for_stmt
    body(target)
  File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/autograph/operators/control_flow.py", line 478, in protected_body
    original_body(protected_iter)
  File "/tmp/__autograph_generated_fileenj3fbm_.py", line 97, in loop_body_1
    ag__.if_stmt(ag__.ld(i) < ag__.ld(self).conv_stages, if_body_2, else_body_2, get_state_3, set_state_3, ('motion_features[i]', 'x'), 2)
  File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/autograph/operators/control_flow.py", line 1363, in if_stmt
    _py_if_stmt(cond, body, orelse)
  File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/autograph/operators/control_flow.py", line 1416, in _py_if_stmt
    return body() if cond else orelse()
  File "/tmp/__autograph_generated_fileenj3fbm_.py", line 57, in if_body_2
    x = ag__.converted_call(ag__.ld(block), (ag__.ld(x),), None, fscope)
  File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/autograph/impl/api.py", line 377, in converted_call
    return _call_unconverted(f, args, kwargs, options)
  File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/autograph/impl/api.py", line 459, in _call_unconverted
    return f(*args)
  File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/keras/utils/traceback_utils.py", line 61, in error_handler
    return fn(*args, **kwargs)
  File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/keras/engine/base_layer.py", line 1097, in __call__
    outputs = call_fn(inputs, *args, **kwargs)
  File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/keras/utils/traceback_utils.py", line 155, in error_handler
    raise new_e.with_traceback(e.__traceback__) from None
  File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/keras/utils/traceback_utils.py", line 96, in error_handler
    return fn(*args, **kwargs)
  File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/autograph/impl/api.py", line 692, in wrapper
    raise e.ag_error_metadata.to_exception(e)
  File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/autograph/impl/api.py", line 689, in wrapper
    return converted_call(f, args, kwargs, options=options)
  File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/autograph/impl/api.py", line 439, in converted_call
    result = converted_f(*effective_args, **kwargs)
  File "/tmp/__autograph_generated_file00x480vc.py", line 10, in tf__call
    x = ag__.converted_call(ag__.ld(self).layers, (ag__.ld(x),), None, fscope)
  File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/autograph/impl/api.py", line 377, in converted_call
    return _call_unconverted(f, args, kwargs, options)
  File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/autograph/impl/api.py", line 459, in _call_unconverted
    return f(*args)
  File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/keras/utils/traceback_utils.py", line 61, in error_handler
    return fn(*args, **kwargs)
  File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/keras/engine/training.py", line 557, in __call__
    return super().__call__(*args, **kwargs)
  File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/keras/utils/traceback_utils.py", line 61, in error_handler
    return fn(*args, **kwargs)
  File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/keras/engine/base_layer.py", line 1097, in __call__
    outputs = call_fn(inputs, *args, **kwargs)
  File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/keras/utils/traceback_utils.py", line 100, in error_handler
    raise e
  File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/keras/utils/traceback_utils.py", line 96, in error_handler
    return fn(*args, **kwargs)
  File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/keras/engine/sequential.py", line 425, in call
    outputs = layer(inputs, **kwargs)
  File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/keras/utils/traceback_utils.py", line 61, in error_handler
    return fn(*args, **kwargs)
  File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/keras/engine/base_layer.py", line 1097, in __call__
    outputs = call_fn(inputs, *args, **kwargs)
  File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/keras/utils/traceback_utils.py", line 155, in error_handler
    raise new_e.with_traceback(e.__traceback__) from None
  File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/keras/utils/traceback_utils.py", line 96, in error_handler
    return fn(*args, **kwargs)
  File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/keras/layers/convolutional/base_conv.py", line 283, in call
    outputs = self.convolution_op(inputs, self.kernel)
  File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/keras/layers/convolutional/base_conv.py", line 255, in convolution_op
    return tf.nn.convolution(
  File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/util/traceback_utils.py", line 141, in error_handler
    return fn(*args, **kwargs)
  File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/util/dispatch.py", line 1176, in op_dispatch_handler
    return dispatch_target(*args, **kwargs)
  File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/ops/nn_ops.py", line 1181, in convolution_v2
    return convolution_internal(
  File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/ops/nn_ops.py", line 1313, in convolution_internal
    return op(
  File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/ops/nn_ops.py", line 2787, in _conv2d_expanded_batch
    return gen_nn_ops.conv2d(
  File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/ops/gen_nn_ops.py", line 1145, in conv2d
    _, _, _op, _outputs = _op_def_library._apply_op_helper(
  File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/framework/op_def_library.py", line 779, in _apply_op_helper
    _ExtractInputsAndAttrs(op_type_name, op_def, allowed_list_attr_map,
  File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/framework/op_def_library.py", line 660, in _ExtractInputsAndAttrs
    _SatisfiesTypeConstraint(
  File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/framework/op_def_library.py", line 58, in _SatisfiesTypeConstraint
    raise TypeError(
TypeError: in user code:
    File "/home/jmw/ing/myfi/vfi/src/model.py", line 366, in train_step  *
        pred,metric = self.interpolator(img0,gt,img1)
    File "/home/jmw/ing/myfi/vfi/src/model.py", line 386, in interpolator  *
        af, mf  = self.feature_estimation(img0, img1) # feature extractor [[2,256,30,60],,...]5개, [[2,256,30,60],...] 3개
    File "/home/jmw/ing/myfi/vfi/src/model.py", line 216, in __call__  *
        x = block(x)  # C C C
    File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/keras/utils/traceback_utils.py", line 61, in error_handler  **
        return fn(*args, **kwargs)
    File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/keras/engine/base_layer.py", line 1097, in __call__
        outputs = call_fn(inputs, *args, **kwargs)
    File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/keras/utils/traceback_utils.py", line 155, in error_handler
        raise new_e.with_traceback(e.__traceback__) from None
    File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/keras/utils/traceback_utils.py", line 96, in error_handler
        return fn(*args, **kwargs)
    File "/tmp/__autograph_generated_file00x480vc.py", line 10, in tf__call  **
        x = ag__.converted_call(ag__.ld(self).layers, (ag__.ld(x),), None, fscope)
    File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/keras/utils/traceback_utils.py", line 61, in error_handler  **
        return fn(*args, **kwargs)
    File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/keras/engine/training.py", line 557, in __call__
        return super().__call__(*args, **kwargs)
    File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/keras/utils/traceback_utils.py", line 61, in error_handler
        return fn(*args, **kwargs)
    File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/keras/engine/base_layer.py", line 1097, in __call__
        outputs = call_fn(inputs, *args, **kwargs)
    File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/keras/utils/traceback_utils.py", line 100, in error_handler
        raise e
    File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/keras/utils/traceback_utils.py", line 96, in error_handler
        return fn(*args, **kwargs)
    File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/keras/engine/sequential.py", line 425, in call
        outputs = layer(inputs, **kwargs)
    File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/keras/utils/traceback_utils.py", line 61, in error_handler
        return fn(*args, **kwargs)
    File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/keras/engine/base_layer.py", line 1097, in __call__
        outputs = call_fn(inputs, *args, **kwargs)
    File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/keras/utils/traceback_utils.py", line 155, in error_handler
        raise new_e.with_traceback(e.__traceback__) from None
    File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/keras/utils/traceback_utils.py", line 96, in error_handler
        return fn(*args, **kwargs)
    File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/keras/layers/convolutional/base_conv.py", line 283, in call
        outputs = self.convolution_op(inputs, self.kernel)
    File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/keras/layers/convolutional/base_conv.py", line 255, in convolution_op
        return tf.nn.convolution(
    File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/util/traceback_utils.py", line 141, in error_handler
        return fn(*args, **kwargs)
    File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/util/dispatch.py", line 1176, in op_dispatch_handler
        return dispatch_target(*args, **kwargs)
    File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/ops/nn_ops.py", line 1181, in convolution_v2
        return convolution_internal(
    File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/ops/nn_ops.py", line 1313, in convolution_internal
        return op(
    File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/ops/nn_ops.py", line 2787, in _conv2d_expanded_batch
        return gen_nn_ops.conv2d(
    File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/ops/gen_nn_ops.py", line 1145, in conv2d
        _, _, _op, _outputs = _op_def_library._apply_op_helper(
    File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/framework/op_def_library.py", line 779, in _apply_op_helper
        _ExtractInputsAndAttrs(op_type_name, op_def, allowed_list_attr_map,
    File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/framework/op_def_library.py", line 660, in _ExtractInputsAndAttrs
        _SatisfiesTypeConstraint(
    File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/framework/op_def_library.py", line 58, in _SatisfiesTypeConstraint
        raise TypeError(
    TypeError: Exception encountered when calling layer "conv_block" "                 f"(type ConvBlock).
    in user code:
        File "/home/jmw/ing/myfi/vfi/src/modules.py", line 416, in call  *
            x = self.layers(x)
        File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/keras/utils/traceback_utils.py", line 61, in error_handler  **
            return fn(*args, **kwargs)
        File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/keras/engine/training.py", line 557, in __call__
            return super().__call__(*args, **kwargs)
        File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/keras/utils/traceback_utils.py", line 61, in error_handler
            return fn(*args, **kwargs)
        File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/keras/engine/base_layer.py", line 1097, in __call__
            outputs = call_fn(inputs, *args, **kwargs)
        File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/keras/utils/traceback_utils.py", line 100, in error_handler
            raise e
        File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/keras/utils/traceback_utils.py", line 96, in error_handler
            return fn(*args, **kwargs)
        File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/keras/engine/sequential.py", line 425, in call
            outputs = layer(inputs, **kwargs)
        File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/keras/utils/traceback_utils.py", line 61, in error_handler
            return fn(*args, **kwargs)
        File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/keras/engine/base_layer.py", line 1097, in __call__
            outputs = call_fn(inputs, *args, **kwargs)
        File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/keras/utils/traceback_utils.py", line 155, in error_handler
            raise new_e.with_traceback(e.__traceback__) from None
        File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/keras/utils/traceback_utils.py", line 96, in error_handler
            return fn(*args, **kwargs)
        File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/keras/layers/convolutional/base_conv.py", line 283, in call
            outputs = self.convolution_op(inputs, self.kernel)
        File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/keras/layers/convolutional/base_conv.py", line 255, in convolution_op
            return tf.nn.convolution(
        File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/util/traceback_utils.py", line 141, in error_handler
            return fn(*args, **kwargs)
        File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/util/dispatch.py", line 1176, in op_dispatch_handler
            return dispatch_target(*args, **kwargs)
        File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/ops/nn_ops.py", line 1181, in convolution_v2
            return convolution_internal(
        File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/ops/nn_ops.py", line 1313, in convolution_internal
            return op(
        File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/ops/nn_ops.py", line 2787, in _conv2d_expanded_batch
            return gen_nn_ops.conv2d(
        File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/ops/gen_nn_ops.py", line 1145, in conv2d
            _, _, _op, _outputs = _op_def_library._apply_op_helper(
        File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/framework/op_def_library.py", line 779, in _apply_op_helper
            _ExtractInputsAndAttrs(op_type_name, op_def, allowed_list_attr_map,
        File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/framework/op_def_library.py", line 660, in _ExtractInputsAndAttrs
            _SatisfiesTypeConstraint(
        File "/home/jmw/anaconda3/envs/vct_tf/lib/python3.9/site-packages/tensorflow/python/framework/op_def_library.py", line 58, in _SatisfiesTypeConstraint
            raise TypeError(
        TypeError: Exception encountered when calling layer "conv2d" "                 f"(type Conv2D).
        Value passed to parameter 'input' has DataType uint8 not in list of allowed values: float16, bfloat16, float32, float64, int32
        Call arguments received by layer "conv2d" "                 f"(type Conv2D):
          • inputs=tf.Tensor(shape=(8, 256, 256, 3), dtype=uint8)
    Call arguments received by layer "conv_block" "                 f"(type ConvBlock):
      • x=tf.Tensor(shape=(8, 256, 256, 3), dtype=uint8)
----------------------------------------------------------------------
Ran 2 tests in 1.334s
FAILED (errors=1, skipped=1)